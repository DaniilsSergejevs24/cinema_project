CREATE TABLE GENRE (
    GenreID INT AUTO_INCREMENT PRIMARY KEY,
    Name VARCHAR(255) NOT NULL
);

CREATE TABLE MOVIE_GENRE (
    MovieGenreID INT AUTO_INCREMENT PRIMARY KEY,
    MovieID INT NOT NULL,
    GenreID INT NOT NULL,
    FOREIGN KEY (MovieID) REFERENCES MOVIE(MovieID),
    FOREIGN KEY (GenreID) REFERENCES GENRE(GenreID)
);

CREATE TABLE MOVIE (
    MovieID INT AUTO_INCREMENT PRIMARY KEY,
    Title VARCHAR(255) NOT NULL,
    Description TEXT,
    MovieGenreID INT,
    Poster BLOB,
    Rating DECIMAL(3,1),
    Duration INT,
    FOREIGN KEY (MovieGenreID) REFERENCES MOVIE_GENRE(MovieGenreID)
);

CREATE TABLE USER (
    UserID INT AUTO_INCREMENT PRIMARY KEY,
    Username VARCHAR(255) NOT NULL,
    Email VARCHAR(255) NOT NULL,
    Password VARCHAR(255) NOT NULL,
    IsAdmin BOOLEAN NOT NULL DEFAULT FALSE,
    ProfilePhoto BLOB
);

CREATE TABLE ScreenType (
    Type VARCHAR(100) PRIMARY KEY,
    Price DECIMAL(10, 2) NOT NULL
);

CREATE TABLE SCREEN (
    ScreenID INT AUTO_INCREMENT PRIMARY KEY,
    Name VARCHAR(255) NOT NULL,
    Type VARCHAR(100),
    TotalSeats INT NOT NULL,
    FOREIGN KEY (Type) REFERENCES ScreenType(Type)
);

CREATE TABLE SEAT (
    SeatID INT AUTO_INCREMENT PRIMARY KEY,
    SeatNumber VARCHAR(10) NOT NULL,
    RowNumber VARCHAR(10) NOT NULL,
    ScreenID INT NOT NULL,
    FOREIGN KEY (ScreenID) REFERENCES SCREEN(ScreenID)
);

CREATE TABLE SHOWTIME (
    ShowtimeID INT AUTO_INCREMENT PRIMARY KEY,
    MovieID INT NOT NULL,
    StartTime DATETIME NOT NULL,
    EndTime DATETIME NOT NULL,
    ScreenID INT NOT NULL,
    FOREIGN KEY (MovieID) REFERENCES MOVIE(MovieID),
    FOREIGN KEY (ScreenID) REFERENCES SCREEN(ScreenID)
);

CREATE TABLE PromoCode (
    PromoCodeID INT AUTO_INCREMENT PRIMARY KEY,
    Code VARCHAR(50) NOT NULL,
    DiscountAmount DECIMAL(5,2) NOT NULL,
    ValidUntil DATETIME NOT NULL,
    UsageLimit INT NOT NULL
);

CREATE TABLE BOOKING (
    BookingID INT AUTO_INCREMENT PRIMARY KEY,
    UserID INT NOT NULL,
    ShowtimeID INT NOT NULL,
    BookingTime DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
    PromoCodeID INT,
    TotalPrice DECIMAL(10,2) NOT NULL,
    FOREIGN KEY (UserID) REFERENCES USER(UserID),
    FOREIGN KEY (ShowtimeID) REFERENCES SHOWTIME(ShowtimeID),
    FOREIGN KEY (PromoCodeID) REFERENCES PromoCode(PromoCodeID)
);

CREATE TABLE BOOKEDSEAT (
    BookedSeatID INT AUTO_INCREMENT PRIMARY KEY,
    BookingID INT NOT NULL,
    SeatID INT NOT NULL,
    FOREIGN KEY (BookingID) REFERENCES BOOKING(BookingID),
    FOREIGN KEY (SeatID) REFERENCES SEAT(SeatID)
);

//////////////////////////////////////////
INSERT INTO ScreenType (Type, Price) VALUES
    ('IMAX', 15.00),
    ('3D', 12.00),
    ('Standard', 10.00),
    ('Mini', 8.00);

